'use strict';var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var LatinTextWrap=function(a){function b(c,d,e){_classCallCheck(this,b);var f=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d,e));return f.textLayer=c,f.newTexts=e,f}return _inherits(b,a),_createClass(b,[{key:'perform',value:function perform(){var h=this;if(!this.textLayer.vertical){var c=this.textLayer.margin,d=this.textLayer.rect.width-c.left-c.right,e='',f=this.textLayer.textCursor.x,g=this.textLayer.textCursor.y;this.newTexts.forEach(function(j,k){if(f>d){f=c.left,g+=h.textLayer.lastLineSize+h.textLayer.style.lineSpacing;for(var m,l=k-e.length;l<k;l++)m=h.newTexts[l],m.rect.x=f,m.rect.y=g,f=m.rect.x+m.rect.width}var n=/[a-zA-Z0-9.,'"?!$#%()@;，、。？！：；《》「」『』À-ÖØ-öø-ÿ]/i.test(j.text);n?e+=j.text:/\s/i.test(j.text)?e='':e=j.text,j.rect.x=f,j.rect.y=g,f+=j.rect.width})}}}]),b}(TextCustomizer);MessageLayer.textCustomizers.latinTextWrap=LatinTextWrap,Tag.actions.toggle_latin_text_wrap=new TagAction({rules:{layer:{type:'MESSAGE_LAYER',required:!0},page:{type:/fore|back/,required:!0}},action:function action(a){var b=a.layer[a.page],c=b.textCustomizers.indexOf('latinTextWrap');return 0<=c?b.textCustomizers.splice(c,1):b.textCustomizers.push('latinTextWrap'),0}});